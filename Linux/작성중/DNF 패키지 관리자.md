# 📘 리눅스 DNF 패키지 관리자

---

## 🧭 패키지 설치의 역사

리눅스에서 프로그램은 보통 **패키지(Package)** 형태로 설치합니다.
Red Hat 계열의 리눅스(RHEL, CentOS, Fedora, Rocky Linux 등)는 `.rpm`이라는 확장자의 **RPM 패키지**를 사용합니다.

### ❗ 초창기에는 문제가 많았어요

* `rpm` 명령어로 설치할 때 **의존성(Dependency)** 을 수동으로 해결해야 했습니다.
* 설치 순서를 지켜야 하고, 중복 설치나 충돌 문제도 자주 발생했습니다.

### ✅ YUM의 등장

이런 문제를 해결하기 위해 **YUM(Yellowdog Updater, Modified)** 이 등장했습니다.

* 인터넷 저장소(Repository)에서 패키지를 자동 검색
* 의존성 자동 설치
* 설치, 제거, 업데이트를 명령어 하나로 처리

하지만 시간이 지나면서 YUM도 속도나 안정성에서 한계를 드러냈습니다.

### 🚀 DNF로 진화

이 문제를 해결하고자 만들어진 것이 **DNF(Dandified YUM)** 입니다.

* Python 3 기반, 성능 향상
* 더 정교한 의존성 처리
* 깔끔한 명령어 체계와 플러그인 지원

> ✅ 요약: `rpm → yum → dnf`는 리눅스 패키지 설치의 진화 과정입니다.

---

## 🤔 요즘 yum을 실행해도?

맞습니다. 현재 Red Hat 계열 리눅스(RHEL 8 이상 등)에서는 `yum` 명령어를 입력해도 **실제로는 dnf가 실행**됩니다.

```bash
$ ls -l /usr/bin/yum
lrwxrwxrwx. 1 root root 5 Jan 1 00:00 /usr/bin/yum -> dnf
```

즉, **yum은 dnf를 가리키는 껍데기(wrapper)** 입니다.
기존 사용자를 위해 남겨둔 명령어라고 보면 됩니다.

---

## 📁 리포지터리(Repository)란?

`dnf`가 패키지를 설치할 때는 인터넷에서 RPM 파일을 다운로드해야 합니다.
이 파일들을 보관하고 있는 **저장소**가 바로 **리포지터리(repository)** 입니다.

### 📦 DNF 설치 시 내부 동작 흐름

1. **활성화된 리포지터리 목록**을 확인합니다.
2. 사용자가 요청한 패키지를 **리포지터리에서 검색**합니다.
3. 해당 패키지와 관련된 **의존성 패키지를 모두 확인**합니다.
4. 필요한 `.rpm` 파일들을 **다운로드**하고
5. **모든 패키지를 설치**합니다.

---

## 📌 리포지터리의 우선순위와 문제점

* 여러 리포지터리가 동시에 존재할 수 있습니다.
* **리포지터리마다 우선순위**가 다르면 설치되는 패키지 버전이 달라질 수 있습니다.
* 예를 들어, EPEL, Remi, RPM Fusion 등이 추가되면 같은 이름의 패키지가 서로 다른 버전으로 존재할 수 있습니다.

> ⚠️ 주의: 리포지터리가 많아질수록 의도하지 않은 버전이 설치되거나, 충돌 문제가 발생할 수 있습니다.

우선순위는 보통 다음 기준으로 결정됩니다:

* `priority` 설정 (예: `/etc/yum.repos.d/*.repo`)
* 먼저 일치한 리포지터리
* 명시적 설정 (`dnf config-manager` 등)

리포 확인 명령어:

```bash
dnf repolist
```

---

## 🛠️ DNF 기본 명령어 모음

| 작업       | 명령어                  | 설명                     |
| -------- | -------------------- | ---------------------- |
| 패키지 설치   | `dnf install <패키지명>` | 예: `dnf install tree`  |
| 패키지 삭제   | `dnf remove <패키지명>`  | 예: `dnf remove tree`   |
| 전체 업데이트  | `dnf update`         | 전체 최신 상태로 유지           |
| 업그레이드    | `dnf upgrade`        | update와 거의 같음          |
| 패키지 검색   | `dnf search <키워드>`   | 예: `dnf search editor` |
| 패키지 정보   | `dnf info <패키지명>`    | 예: `dnf info tree`     |
| 설치 목록 확인 | `dnf list installed` | 현재 설치된 패키지 확인          |
| 캐시 삭제    | `dnf clean all`      | 불필요한 파일 제거             |
| 캐시 새로 받기 | `dnf makecache`      | 캐시 미리 준비               |

---

## ✍️ 실습 예제: `tree` 유틸리티 설치하고 사용해보기

패키지 설치는 단순히 "설치"만 하는 게 아니라, **실제로 사용하는 것**까지 확인해야 합니다.
`tree`라는 간단한 명령어 프로그램을 설치해봅니다.

### ✅ 1. 설치

```bash
sudo dnf install tree
```

설치가 완료되면 아래처럼 사용할 수 있습니다.

### ✅ 2. 사용

```bash
tree
```

현재 디렉토리 구조가 나무 형태로 출력됩니다.
`tree`는 설치 직후 바로 사용할 수 있습니다.

---

## 🔄 dnf history로 설치/삭제 이력 관리

`dnf history` 명령어를 사용하면 **이전에 실행한 dnf 작업 이력**을 확인할 수 있습니다.

### 명령어 예시

| 작업      | 명령어                     | 설명                    |
| ------- | ----------------------- | --------------------- |
| 이력 보기   | `dnf history`           | 설치/삭제/업데이트 내역 목록      |
| 세부 보기   | `dnf history info <번호>` | 해당 작업의 상세 정보          |
| 작업 되돌리기 | `dnf history undo <번호>` | 특정 설치/업데이트/삭제 작업을 되돌림 |
| 전체 초기화  | `dnf history reset`     | 모든 기록 초기화 (주의 필요)     |

> 이 기능은 실수로 설치하거나 지운 패키지를 **되돌릴 수 있게 해주는 매우 유용한 기능**입니다.

---

## 🧠 실무 팁 요약

* 여러 패키지 설치:

  ```bash
  sudo dnf install git vim curl
  ```
* 설치 여부 확인:

  ```bash
  dnf list installed | grep vim
  ```
* 특정 패키지 업데이트 제외:

  ```bash
  sudo dnf upgrade --exclude=kernel*
  ```

---

## ⚠️ 자주 하는 실수

| 상황           | 설명 및 해결 방법                          |
| ------------ | ----------------------------------- |
| `sudo` 빠짐    | 시스템 변경이므로 `sudo`가 꼭 필요              |
| 설치했는데 실행 안 됨 | 경로 설정, systemctl 설정 확인              |
| 네트워크 안 됨     | DNF는 인터넷 연결이 필수                     |
| 패키지 충돌       | 리포지터리 중복, 버전 충돌 가능성 → 필요 없는 리포 비활성화 |

---

## 📎 마무리 요약

* DNF는 Red Hat 계열 리눅스의 **공식 패키지 관리자**입니다.
* 과거 YUM의 문제를 개선하며 더 빠르고 안정적으로 작동합니다.
* 리포지터리를 기반으로 패키지를 검색하고 의존성을 자동 해결합니다.
* `yum` 명령어는 여전히 사용 가능하지만 내부적으로 `dnf`가 실행됩니다.
* `dnf history`로 설치/삭제 이력을 관리할 수 있습니다.

---